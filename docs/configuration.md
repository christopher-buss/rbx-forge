# Configuration

rbx-forge uses configuration files to customize behavior and workflows.
Configuration is automatically detected from your project.

## Configuration Options

### Recommended: TypeScript Config

**`rbx-forge.config.ts`** - Full TypeScript support with IntelliSense:

```typescript
import { defineConfig } from "rbx-forge";

export default defineConfig({
	buildOutputPath: "game.rbxl",
	projectType: "rbxts",
});
```

The `defineConfig()` helper provides type safety and autocomplete. Run
`rbx-forge init` to create this file automatically.

### Alternative: JSON Config

**`rbx-forge.config.json`** - Simple JSON format:

```json
{
	"buildOutputPath": "game.rbxl",
	"projectType": "rbxts"
}
```

**Note:** JSON config doesn't support comments or type checking.

### Alternative: package.json

Add an `"rbx-forge"` key to your package.json:

```json
{
	"name": "my-roblox-project",
	"version": "1.0.0",
	"rbx-forge": {
		"buildOutputPath": "game.rbxl",
		"projectType": "rbxts"
	}
}
```

Good for simple configs that live with your project metadata.

### Other Formats

rbx-forge uses [c12](https://github.com/unjs/c12) for configuration loading,
which supports additional formats like `.mjs`, `.cjs`, `.yaml`, `.toml`, RC
files, and more. See the
[c12 documentation](https://github.com/unjs/c12#-features) for all supported
formats.

### Configuration Priority

If multiple configuration sources exist, they're loaded in this order (highest
priority first):

1. `rbx-forge.config.ts` (or `.json`) in current directory
2. `package.json` `"rbx-forge"` key
3. Global config files

**Tip:** Stick with `rbx-forge.config.ts` for the best development experience
with type checking and autocomplete.

## Available Options

### `projectType`

**Type:** `"rbxts" | "luau"` **Default:** `"rbxts"`

Specifies the project type. Determines which compiler/build tools are used.

- `"rbxts"` - roblox-ts TypeScript project
- `"luau"` - Pure Luau project

**Example:**

```typescript
export default defineConfig({
	projectType: "rbxts",
});
```

---

### `buildOutputPath`

**Type:** `string` **Default:** `"game.rbxl"`

Path where the Rojo build output will be saved.

**Example:**

```typescript
export default defineConfig({
	buildOutputPath: "build/game.rbxl",
});
```

---

### `rojoProjectPath`

**Type:** `string` **Default:** `"default.project.json"`

Path to the Rojo project file to use for all commands. This allows you to use
different project files instead of the default `default.project.json`.

Commands that support the `--project` flag will use this config value as the
default, but the flag will override it if provided.

**Example:**

```typescript
export default defineConfig({
	rojoProjectPath: "custom.project.json",
});
```

**Use Cases:**

- Multiple project configurations (e.g., dev vs production)
- Custom project file naming conventions
- Monorepo setups with multiple Rojo projects

---

### `commandNames`

**Type:** `object` **Default:** See below

Customize the names of task runner scripts generated by `rbx-forge init`. This
allows you to organize your scripts with custom prefixes or naming schemes.

**Default values:**

```text
{
	build: "forge:build",
	compile: "forge:compile",
	init: "init",
	open: "forge:open",
	restart: "forge:restart",
	serve: "forge:serve",
	start: "forge:start",
	stop: "forge:stop",
	syncback: "forge:syncback",
	typegen: "forge:typegen",
	watch: "forge:watch",
}
```

**Properties:**

- `build` - Name for build command script
- `compile` - Name for compile command script
- `init` - Name for init command script
- `open` - Name for open command script
- `restart` - Name for restart command script
- `serve` - Name for serve command script
- `start` - Name for start command script
- `stop` - Name for stop command script
- `syncback` - Name for syncback command script
- `typegen` - Name for typegen command script
- `watch` - Name for watch command script

**Example:**

```typescript
export default defineConfig({
	commandNames: {
		build: "dev:build",
		serve: "dev:serve",
		watch: "dev:watch",
	},
});
```

This will generate scripts like:

```json
{
	"scripts": {
		"dev:build": "rbx-forge build",
		"dev:serve": "rbx-forge serve",
		"dev:watch": "rbx-forge watch"
	}
}
```

---

### `rbxts`

**Type:** `object` **Default:** See below

Configuration for roblox-ts compiler (only applies when `projectType: "rbxts"`).

**Default values:**

```text
{
	command: "rbxtsc",
	args: ["--verbose"],
	watchOnOpen: true,
}
```

**Properties:**

#### `rbxts.command`

**Type:** `string` **Default:** `"rbxtsc"`

The roblox-ts compiler command to execute.

#### `rbxts.args`

**Type:** `string[]` **Default:** `["--verbose"]`

Additional arguments to pass to the compiler.

#### `rbxts.watchOnOpen`

**Type:** `boolean` **Default:** `true`

Whether to automatically start watch mode when opening in Studio.

**Example:**

```typescript
export default defineConfig({
	projectType: "rbxts",
	rbxts: {
		args: ["--verbose", "--logTruthyChanges"],
		command: "rbxtsc",
		watchOnOpen: true,
	},
});
```

---

### `luau`

**Type:** `object` **Default:** See below

Configuration for Luau projects (only applies when `projectType: "luau"`).

**Default values:**

```text
{
	watch: {
		command: "",
		args: [],
	},
}
```

**Properties:**

#### `luau.watch.command`

**Type:** `string` **Default:** `""`

Command to run when watching Luau projects (e.g., a build tool or formatter).

#### `luau.watch.args`

**Type:** `string[]` **Default:** `[]`

Additional arguments to pass to the watch command.

**Example:**

```typescript
export default defineConfig({
	luau: {
		watch: {
			args: ["process", "src", "out"],
			command: "darklua",
		},
	},
	projectType: "luau",
});
```

---

### `syncback`

**Type:** `object` **Default:** `{ runOnStart: false }`

Configuration for syncback functionality (requires UpliftGames Rojo fork).

**Properties:**

#### `syncback.runOnStart`

**Type:** `boolean` **Default:** `false`

Whether to automatically run syncback when using the `start` command.

**Example:**

```typescript
export default defineConfig({
	syncback: {
		runOnStart: true,
	},
});
```

---

### `syncbackInputPath`

**Type:** `string` **Default:** `"game.rbxl"`

Path to the place file to sync back from.

**Example:**

```typescript
export default defineConfig({
	syncbackInputPath: "build/game.rbxl",
});
```

---

### `typegen`

**Type:** `object` **Default:** See below

Configuration for TypeScript type generation from Rojo sourcemap.

**Default values:**

```text
{
	include: ["**"],
	exclude: ["**/node_modules/**"],
	maxDepth: undefined,
}
```

**Properties:**

#### `typegen.include`

**Type:** `string[]` **Default:** `["**"]`

Glob patterns for files to include in type generation.

#### `typegen.exclude`

**Type:** `string[]` **Default:** `["**/node_modules/**"]`

Glob patterns for files to exclude from type generation.

#### `typegen.maxDepth`

**Type:** `number | undefined` **Default:** `undefined`

Maximum depth to traverse when generating types. `undefined` means no limit.

**Example:**

```typescript
export default defineConfig({
	typegen: {
		exclude: ["**/node_modules/**", "**/test/**"],
		include: ["src/**"],
		maxDepth: 5,
	},
});
```

---

### `typegenOutputPath`

**Type:** `string` **Default:** `"src/services.d.ts"`

Path where generated TypeScript types will be written.

**Example:**

```typescript
export default defineConfig({
	typegenOutputPath: "src/types/services.d.ts",
});
```

---

### `suppressNoTaskRunnerWarning`

**Type:** `boolean` **Default:** `false`

Suppress warnings when no task runner (npm/mise) is detected during command
chaining.

**Example:**

```typescript
export default defineConfig({
	suppressNoTaskRunnerWarning: true,
});
```

---

## Complete Example

Here's a complete configuration example showing all options:

```typescript
import { defineConfig } from "rbx-forge";

export default defineConfig({
	// Build configuration
	buildOutputPath: "build/game.rbxl",

	// Custom task runner script names
	commandNames: {
		build: "dev:build",
		compile: "dev:compile",
		init: "init",
		open: "dev:open",
		restart: "dev:restart",
		serve: "dev:serve",
		start: "dev:start",
		stop: "dev:stop",
		syncback: "dev:syncback",
		typegen: "dev:typegen",
		watch: "dev:watch",
	},

	// Luau configuration (if projectType: "luau")
	luau: {
		watch: {
			args: ["process", "src", "out"],
			command: "darklua",
		},
	},

	// Project type
	projectType: "rbxts",

	// roblox-ts configuration
	rbxts: {
		args: ["--verbose", "--logTruthyChanges"],
		command: "rbxtsc",
		watchOnOpen: true,
	},

	// Rojo project file path
	rojoProjectPath: "default.project.json",

	// Suppress task runner warnings
	suppressNoTaskRunnerWarning: false,
	// Syncback configuration
	syncback: {
		runOnStart: false,
	},

	syncbackInputPath: "build/game.rbxl",
	// Type generation configuration
	typegen: {
		exclude: ["**/node_modules/**", "**/test/**"],
		include: ["src/**"],
		maxDepth: 5,
	},

	typegenOutputPath: "types/roblox-services.d.ts",
});
```

## Environment-Specific Configuration

You can use different configurations for different environments:

```typescript
import { defineConfig } from "rbx-forge";

const isDevelopment = process.env.NODE_ENV === "development";

export default defineConfig({
	buildOutputPath: isDevelopment ? "game.rbxl" : "dist/game.rbxl",
	projectType: "rbxts",
	rbxts: {
		args: isDevelopment ? ["--verbose"] : ["--verbose", "--production"],
		command: "rbxtsc",
		watchOnOpen: isDevelopment,
	},
});
```

## Type Safety

The `defineConfig()` helper provides full TypeScript type checking:

```typescript
import { defineConfig } from "rbx-forge";

export default defineConfig({
	buildOutputPath: "game.rbxl",
	projectType: "rbxts",
	// TypeScript will error on invalid options
	// invalidOption: true, // ‚ùå Error!
});
```

## Validation

All configuration options are validated at runtime using arktype. If you provide
an invalid configuration, you'll get a clear error message explaining what's
wrong.
